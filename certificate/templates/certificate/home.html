{% extends 'certificate/base.html' %}

{% block title %}Repositorio de Certificados PDF de CENDITEL{% endblock %}

{% block content %}
<div align="center">
    <h1 class="h1-main">Repositorio de Certificados Digitales</h1>
    <br>
    <h4>
        Por favor escriba su cédula de identidad o número
        <br />
        de identificación sin puntos ni espacios.
    </h4>
    <br>
    <form method="get" action="{% url 'busqueda' %}">
        <div class="mb-4">
            <input
                type="text"
                class="form-control form-cedula"
                id="cedula"
                name="q"
                placeholder="Cédula ó ID"
                value="{{ query|default:'' }}"
                required
                pattern="[0-9]+"
            >
        </div>

        <!-- Botón reset -->
        <a href="{% url 'buscar' %}" class="btn btn-secondary btn-md">
            <i class="fas fa-broom"></i> Limpiar
        </a>
        <!-- Final de Botón reset -->

        <!-- Botón de buscar -->
        <button type="submit" class="btn btn-primary btn-md">
            <i class="fas fa-search"></i> Buscar
        </button>
        <!-- Final de Botón de buscar -->
    </form>

    <br />

    {% if certificados %}
        <p>
            Estás buscando certificados con la cédula o
            <br>
            número de identificación:
            <strong>{{ query }}</strong>
        </p>
        <div class="certificates-found">
            <h4>
                Certificados encontrados: {{ certificados|length }}
                certificado/s.
            </h4>
        </div>

        <table class="table table-striped">
            <thead>
                <tr>
                <th><b>Nombre y Apellido</b></th>
                <th><b>Cédula o ID</b></th>
                <th><b>Evento / Curso</b></th>
                <th><b>Rol</b></th>
                <th><b>Fecha</b></th>
                <th><b>Ubicación electrónica</b></th>
                </tr>
            </thead>
            {% for x in certificados %}
                <tbody>
                    <tr>
                        <td>
                            {{ x.nombre_completo }}
                        </td>
                        <td>
                            {{ x.cedula }}
                        </td>
                        <td>
                            {{ x.evento_curso }}
                        </td>
                        <td>
                            {{ x.rol }}
                        </td>
                        <td>
                            {{ x.uploaded_at | date:"d/m/y" }}
                        </td>
                        <td>
                            <a href="media/{{ x.certificado }}" target="_blank">
                            <button class="btn btn-default btn-grad-green">
                                <span class="glyphicon glyphicon-download-alt" aria-hidden="true"></span>
                                DESCARGAR
                            </button>
                            </a>
                        </td>
                    </tr>
                </tbody>
            {% endfor %}
        </table>
    {% else %}
    {% endif %}
</div>
{% endblock %}
